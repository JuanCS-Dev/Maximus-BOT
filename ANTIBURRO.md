# üéØ MANUAL ANTIBURRO
## Guia Definitivo do V√©rtice Discord Bot - Do Zero ao Deploy

> **"Se voc√™ consegue respirar, voc√™ consegue rodar este bot."**
>
> Este manual foi feito para pessoas que nunca mexeram com Discord bots, Node.js, Docker, ou qualquer outra tecnologia usada aqui. Se voc√™ seguir passo a passo, VAI FUNCIONAR.

---

## üìö √çNDICE

1. [O Que √â Este Bot?](#1-o-que-√©-este-bot)
2. [Pr√©-Requisitos (O Que Voc√™ Precisa Instalar)](#2-pr√©-requisitos)
3. [Configura√ß√£o Inicial (Primeira Vez)](#3-configura√ß√£o-inicial)
4. [Como Rodar o Bot (Modo Desenvolvimento)](#4-como-rodar-o-bot-modo-desenvolvimento)
5. [Como Rodar o Bot (Modo Produ√ß√£o com Docker)](#5-como-rodar-o-bot-modo-produ√ß√£o-com-docker)
6. [Configurando Integra√ß√µes Externas](#6-configurando-integra√ß√µes-externas)
7. [Comandos Dispon√≠veis no Discord](#7-comandos-dispon√≠veis-no-discord)
8. [Troubleshooting (Quando Algo D√° Errado)](#8-troubleshooting)
9. [Como Adicionar Novos Comandos](#9-como-adicionar-novos-comandos)
10. [Perguntas Frequentes (FAQ)](#10-perguntas-frequentes)
11. [Gloss√°rio (O Que Significa Cada Termo)](#11-gloss√°rio)

---

## 1. O QUE √â ESTE BOT?

### ü§î Em Portugu√™s Claro

Este bot √© um **guarda de seguran√ßa automatizado** para o seu servidor Discord. Ele:

- üõ°Ô∏è **Protege** contra spam, raids, e conte√∫do malicioso
- üîç **Detecta amea√ßas** em tempo real (URLs suspeitas, malware, phishing)
- üö® **Alerta moderadores** quando encontra algo perigoso
- üìä **Registra tudo** para auditoria e compliance
- ü§ñ **Age automaticamente** (deleta mensagens, timeout em usu√°rios, bane atacantes)
- üîó **Se conecta** com plataformas de intelig√™ncia de amea√ßas (MISP, OpenCTI)

### üéØ Para Quem √â Este Bot?

- Servidores Discord que precisam de **seguran√ßa enterprise**
- Administradores que querem **automa√ß√£o de modera√ß√£o**
- Equipes de seguran√ßa que precisam de **incident response**
- Comunidades grandes (2.500+ membros) que precisam de **escalabilidade**

### üí° O Que Voc√™ Vai Conseguir Fazer?

Depois de seguir este manual, voc√™ ser√° capaz de:

1. ‚úÖ Rodar o bot no seu computador (desenvolvimento)
2. ‚úÖ Rodar o bot em produ√ß√£o (Docker)
3. ‚úÖ Configurar detec√ß√£o de amea√ßas
4. ‚úÖ Conectar com MISP/OpenCTI
5. ‚úÖ Adicionar novos comandos
6. ‚úÖ Resolver problemas sozinho

---

## 2. PR√â-REQUISITOS

### üñ•Ô∏è O Que Voc√™ Precisa Instalar ANTES

#### A. Node.js (Obrigat√≥rio)

**O que √©?** Node.js √© o "motor" que roda c√≥digo JavaScript no servidor.

**Como instalar:**

##### üêß Linux (Ubuntu/Debian):
```bash
# 1. Atualizar reposit√≥rios
sudo apt update

# 2. Instalar Node.js 22.x LTS
curl -fsSL https://deb.nodesource.com/setup_22.x | sudo -E bash -
sudo apt install -y nodejs

# 3. Verificar instala√ß√£o
node --version   # Deve mostrar: v22.x.x
npm --version    # Deve mostrar: 10.x.x
```

##### üçé macOS:
```bash
# Instalar via Homebrew (se n√£o tem Homebrew, instale primeiro: https://brew.sh)
brew install node@22

# Verificar instala√ß√£o
node --version
npm --version
```

##### ü™ü Windows:
1. Baixe o instalador: https://nodejs.org/en/download/
2. Execute o instalador (clique em "Next" at√© o fim)
3. Abra o Prompt de Comando e verifique:
```cmd
node --version
npm --version
```

---

#### B. Docker (Opcional, mas Recomendado)

**O que √©?** Docker √© como uma "m√°quina virtual leve" que roda aplica√ß√µes isoladas.

**Quando usar?** Para produ√ß√£o, ou se voc√™ quer rodar PostgreSQL/Redis localmente.

**Como instalar:**

##### üêß Linux:
```bash
# 1. Instalar Docker
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

# 2. Adicionar seu usu√°rio ao grupo docker (para n√£o precisar de sudo)
sudo usermod -aG docker $USER

# 3. Reiniciar sess√£o (logout e login novamente)

# 4. Instalar Docker Compose
sudo apt install docker-compose-plugin

# 5. Verificar instala√ß√£o
docker --version
docker compose version
```

##### üçé macOS:
1. Baixe Docker Desktop: https://www.docker.com/products/docker-desktop/
2. Instale o aplicativo
3. Abra Docker Desktop (deixe rodando)
4. Verifique no terminal:
```bash
docker --version
docker compose version
```

##### ü™ü Windows:
1. Baixe Docker Desktop: https://www.docker.com/products/docker-desktop/
2. Instale o aplicativo
3. Abra Docker Desktop
4. Verifique no PowerShell:
```cmd
docker --version
docker compose version
```

---

#### C. Git (Obrigat√≥rio)

**O que √©?** Git √© a ferramenta de controle de vers√£o de c√≥digo.

**Como instalar:**

##### üêß Linux:
```bash
sudo apt install git
git --version
```

##### üçé macOS:
```bash
# J√° vem instalado, mas pode atualizar:
brew install git
git --version
```

##### ü™ü Windows:
1. Baixe: https://git-scm.com/download/win
2. Instale com configura√ß√µes padr√£o
3. Verifique:
```cmd
git --version
```

---

#### D. Editor de C√≥digo (Recomendado)

**Sugest√£o:** Visual Studio Code (VSCode)

**Download:** https://code.visualstudio.com/

**Por que?** Facilita editar arquivos `.env`, c√≥digo TypeScript, etc.

---

### ‚úÖ Checklist de Pr√©-Requisitos

Antes de continuar, verifique se voc√™ tem:

- [ ] Node.js 22.x instalado (`node --version`)
- [ ] npm instalado (`npm --version`)
- [ ] Git instalado (`git --version`)
- [ ] Docker instalado (opcional, `docker --version`)
- [ ] Editor de c√≥digo (VSCode recomendado)

---

## 3. CONFIGURA√á√ÉO INICIAL

### üì• Passo 1: Clonar o Reposit√≥rio

```bash
# 1. Abra o terminal (ou Prompt de Comando no Windows)

# 2. Navegue at√© a pasta onde quer salvar o projeto
cd ~/Documentos  # Exemplo: pasta Documentos

# 3. Clone o reposit√≥rio
git clone https://github.com/JuanCS-Dev/Maximus-BOT.git

# 4. Entre na pasta do projeto
cd Maximus-BOT

# 5. Verifique se est√° na pasta certa
ls  # Linux/macOS
dir # Windows
# Voc√™ deve ver: src/, package.json, docker-compose.yml, etc.
```

---

### üì¶ Passo 2: Instalar Depend√™ncias

```bash
# 1. Certifique-se de estar na pasta do projeto
pwd  # Linux/macOS (deve mostrar: .../Maximus-BOT)
cd   # Windows (deve mostrar: ...\Maximus-BOT)

# 2. Instalar todas as depend√™ncias
npm install

# 3. Aguarde... (pode levar 2-5 minutos)
# Voc√™ ver√° muitas mensagens aparecendo. Isso √© normal.

# 4. Quando terminar, voc√™ deve ver:
# "added XXX packages"
```

**‚ö†Ô∏è Erros comuns:**
- `npm: command not found` ‚Üí Voc√™ n√£o instalou Node.js corretamente (volte ao Passo 2A)
- `permission denied` ‚Üí Use `sudo npm install` (Linux/macOS) ou abra terminal como Admin (Windows)

---

### ü§ñ Passo 3: Criar Bot no Discord Developer Portal

**Este √© o passo mais importante. Siga com ATEN√á√ÉO.**

#### 3.1. Acessar Discord Developer Portal

1. Abra seu navegador
2. Acesse: https://discord.com/developers/applications
3. Fa√ßa login com sua conta Discord

#### 3.2. Criar Nova Aplica√ß√£o

1. Clique em **"New Application"** (canto superior direito)
2. Digite um nome: `V√©rtice Bot` (ou o nome que quiser)
3. Marque a caixa "I agree to the Terms of Service"
4. Clique em **"Create"**

#### 3.3. Obter o Application ID (CLIENT_ID)

1. Na p√°gina da aplica√ß√£o, procure **"APPLICATION ID"**
2. Clique em **"Copy"** (√≠cone de copiar)
3. Cole em um bloco de notas temporariamente

#### 3.4. Criar o Bot

1. No menu lateral esquerdo, clique em **"Bot"**
2. Clique em **"Add Bot"** ‚Üí **"Yes, do it!"**
3. Voc√™ ver√° a p√°gina do bot

#### 3.5. Obter o Token do Bot (DISCORD_TOKEN)

**‚ö†Ô∏è ATEN√á√ÉO: O token √© como uma senha. NUNCA compartilhe!**

1. Na se√ß√£o **"TOKEN"**, clique em **"Reset Token"**
2. Confirme clicando em **"Yes, do it!"**
3. Copie o token que apareceu (come√ßa com `MT` ou `Nz`)
4. **Cole em um bloco de notas** (voc√™ vai precisar depois)
5. **NUNCA compartilhe este token com ningu√©m!**

#### 3.6. Configurar Intents (MUITO IMPORTANTE)

**O que s√£o Intents?** S√£o "permiss√µes" que o bot precisa para ler mensagens.

1. Na mesma p√°gina (Bot), role para baixo at√© **"Privileged Gateway Intents"**
2. **ATIVE as 3 op√ß√µes:**
   - ‚úÖ **PRESENCE INTENT** (opcional, mas recomendado)
   - ‚úÖ **SERVER MEMBERS INTENT** (obrigat√≥rio)
   - ‚úÖ **MESSAGE CONTENT INTENT** (obrigat√≥rio)
3. Clique em **"Save Changes"** (canto inferior)

**‚ö†Ô∏è SEM MESSAGE CONTENT INTENT, O BOT N√ÉO FUNCIONA!**

#### 3.7. Convidar Bot para Seu Servidor

1. No menu lateral, clique em **"OAuth2"** ‚Üí **"URL Generator"**
2. Em **"SCOPES"**, marque:
   - ‚úÖ `bot`
   - ‚úÖ `applications.commands`
3. Em **"BOT PERMISSIONS"**, marque:
   - ‚úÖ `Administrator` (mais f√°cil) OU selecione manualmente:
     - ‚úÖ `Manage Messages`
     - ‚úÖ `Manage Roles`
     - ‚úÖ `Manage Channels`
     - ‚úÖ `Kick Members`
     - ‚úÖ `Ban Members`
     - ‚úÖ `Read Message History`
     - ‚úÖ `Send Messages`
     - ‚úÖ `Embed Links`
     - ‚úÖ `Attach Files`
     - ‚úÖ `Moderate Members` (para timeout)
4. Role para baixo e copie a **"GENERATED URL"**
5. Cole a URL no navegador
6. Selecione o servidor onde quer adicionar o bot
7. Clique em **"Authorize"** (Autorizar)
8. Complete o CAPTCHA

**‚úÖ Pronto! O bot agora est√° no seu servidor (mas ainda offline).**

---

### üîë Passo 4: Configurar Vari√°veis de Ambiente (.env)

**O que √© .env?** √â um arquivo secreto onde voc√™ guarda tokens, senhas, URLs, etc.

#### 4.1. Criar Arquivo .env

```bash
# 1. Na pasta do projeto, copie o exemplo
cp .env.example .env

# 2. Abra o arquivo .env no editor
# VSCode:
code .env

# Ou qualquer editor de texto:
nano .env  # Linux
notepad .env  # Windows
```

#### 4.2. Preencher Vari√°veis OBRIGAT√ìRIAS

Edite o arquivo `.env` e preencha:

```bash
# ========================================
# OBRIGAT√ìRIO - N√£o funciona sem isso!
# ========================================

# Node Environment (desenvolvimento ou produ√ß√£o)
NODE_ENV=development

# Discord Bot Token (copiado no Passo 3.5)
DISCORD_TOKEN=SEU_TOKEN_AQUI

# Discord Application ID (copiado no Passo 3.3)
CLIENT_ID=SEU_CLIENT_ID_AQUI

# Discord Guild ID (ID do seu servidor)
# Como obter: Discord ‚Üí Configura√ß√µes ‚Üí Avan√ßado ‚Üí Ativar "Modo Desenvolvedor"
# Depois: Clique com bot√£o direito no seu servidor ‚Üí "Copiar ID do Servidor"
GUILD_ID=SEU_GUILD_ID_AQUI

# Logging Level (debug = mais detalhado, info = normal, error = s√≥ erros)
LOG_LEVEL=debug

# ========================================
# BANCO DE DADOS (PostgreSQL)
# ========================================

# Para desenvolvimento local (se usar Docker):
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/vertice_bot

# Para produ√ß√£o (substitua com suas credenciais):
# DATABASE_URL=postgresql://usuario:senha@host:5432/banco

# ========================================
# CACHE (Redis)
# ========================================

# Para desenvolvimento local (se usar Docker):
REDIS_URL=redis://localhost:6379

# Para produ√ß√£o (substitua com suas credenciais):
# REDIS_URL=redis://usuario:senha@host:6379

# ========================================
# DETEC√á√ÉO DE AMEA√áAS
# ========================================

# Score m√≠nimo para tomar a√ß√£o (0-100)
# 80 = apenas amea√ßas cr√≠ticas
# 50 = amea√ßas m√©dias e cr√≠ticas
THREAT_SCORE_THRESHOLD=80

# Google Safe Browsing API (OPCIONAL - melhora detec√ß√£o)
# Obter em: https://console.cloud.google.com/apis/credentials
GOOGLE_SAFE_BROWSING_API_KEY=

# VirusTotal API (OPCIONAL - melhora detec√ß√£o)
# Obter em: https://www.virustotal.com/gui/my-apikey
VIRUSTOTAL_API_KEY=

# ========================================
# MISP (OPCIONAL - Threat Intelligence)
# ========================================

MISP_ENABLED=false
MISP_URL=
MISP_API_KEY=

# ========================================
# OpenCTI (OPCIONAL - Threat Intelligence)
# ========================================

OPENCTI_ENABLED=false
OPENCTI_URL=
OPENCTI_API_KEY=

# ========================================
# V√©rtice-MAXIMUS (OPCIONAL)
# ========================================

VERTICE_MAXIMUS_ENABLED=false
VERTICE_MAXIMUS_URL=
VERTICE_MAXIMUS_API_KEY=

# ========================================
# ESCALABILIDADE (OPCIONAL)
# ========================================

# N√∫mero de shards (auto = calcula automaticamente)
SHARD_COUNT=auto

# M√©tricas Prometheus
METRICS_ENABLED=true
METRICS_PORT=9090
```

#### 4.3. Exemplo de .env M√≠nimo Funcional

Se voc√™ quer apenas **testar o bot SEM Docker**, use:

```bash
NODE_ENV=development
DISCORD_TOKEN=MTIzNDU2Nzg5MDEyMzQ1Njc4.ABCDEF.xyzXYZ123456789
CLIENT_ID=1234567890123456789
GUILD_ID=9876543210987654321
LOG_LEVEL=debug
THREAT_SCORE_THRESHOLD=80

# Banco de dados e Redis s√£o opcionais para teste r√°pido
# O bot vai funcionar, mas sem persist√™ncia
DATABASE_URL=
REDIS_URL=
```

**‚ö†Ô∏è Salve o arquivo e feche!**

---

### üóÑÔ∏è Passo 5: Configurar Banco de Dados (Prisma)

#### 5.1. Op√ß√£o A: Usar Docker (Recomendado)

```bash
# 1. Iniciar PostgreSQL e Redis via Docker
docker compose up -d postgres redis

# 2. Aguardar 10 segundos para os servi√ßos iniciarem
sleep 10

# 3. Gerar Prisma Client
npm run prisma:generate

# 4. Rodar migrations (criar tabelas)
npm run prisma:push

# 5. Verificar se funcionou
docker compose ps
# Deve mostrar postgres e redis como "running"
```

#### 5.2. Op√ß√£o B: Usar Banco de Dados Externo

Se voc√™ tem PostgreSQL e Redis j√° instalados OU usa um servi√ßo na nuvem:

```bash
# 1. Configure DATABASE_URL e REDIS_URL no .env com suas credenciais

# 2. Gerar Prisma Client
npm run prisma:generate

# 3. Rodar migrations
npm run prisma:push
```

#### 5.3. Op√ß√£o C: Testar Sem Banco de Dados

**‚ö†Ô∏è N√£o recomendado para produ√ß√£o, mas funciona para testar:**

```bash
# Apenas gere o cliente (mesmo sem banco)
npm run prisma:generate

# O bot vai rodar, mas sem salvar dados
```

---

### ‚úÖ Checklist de Configura√ß√£o Inicial

Antes de prosseguir, verifique:

- [ ] Reposit√≥rio clonado
- [ ] Depend√™ncias instaladas (`npm install`)
- [ ] Bot criado no Discord Developer Portal
- [ ] Token do bot copiado
- [ ] Intents ativados (MESSAGE CONTENT INTENT)
- [ ] Bot adicionado ao servidor
- [ ] Arquivo `.env` criado e preenchido
- [ ] Prisma Client gerado
- [ ] Banco de dados configurado (ou pulado para teste)

**‚úÖ Se tudo est√° OK, prossiga para rodar o bot!**

---

## 4. COMO RODAR O BOT (MODO DESENVOLVIMENTO)

### üöÄ Rodando pela Primeira Vez

```bash
# 1. Certifique-se de estar na pasta do projeto
cd /caminho/para/Maximus-BOT

# 2. Iniciar o bot em modo desenvolvimento (com auto-reload)
npm run dev

# 3. Voc√™ deve ver:
# [INFO] ü§ñ V√©rtice Bot est√° online!
# [INFO] ‚úÖ Comandos registrados no servidor!
# [INFO] üü¢ Conectado como: SeuBot#1234
```

### ‚úÖ Como Saber Se Funcionou?

1. **No terminal**, voc√™ deve ver:
   ```
   [INFO] ü§ñ V√©rtice Bot est√° online!
   ```

2. **No Discord**, o bot deve aparecer **online** (bolinha verde) na lista de membros

3. **Teste um comando**:
   - No Discord, digite: `/ping`
   - O bot deve responder: "Pong! üèì"

### üõë Como Parar o Bot?

No terminal, pressione: `Ctrl + C`

### üîÑ Como Reiniciar o Bot?

```bash
# Parar (Ctrl + C) e rodar novamente:
npm run dev
```

---

## 5. COMO RODAR O BOT (MODO PRODU√á√ÉO COM DOCKER)

### üê≥ Por Que Usar Docker?

- ‚úÖ **Isolamento**: Bot roda em container separado
- ‚úÖ **Facilidade**: Todos os servi√ßos (bot, banco, Redis, MISP) em um comando
- ‚úÖ **Escalabilidade**: F√°cil de replicar em servidores
- ‚úÖ **Produ√ß√£o**: Recomendado para ambientes reais

### üì¶ Passo 1: Buildar o Projeto

```bash
# 1. Compilar TypeScript para JavaScript
npm run build

# 2. Verificar se criou a pasta dist/
ls dist/  # Linux/macOS
dir dist\ # Windows
```

### üöÄ Passo 2: Iniciar Todos os Servi√ßos

```bash
# 1. Iniciar TUDO (bot, PostgreSQL, Redis, Prometheus, Grafana)
docker compose up -d

# 2. Aguardar 30 segundos (primeira vez demora mais)

# 3. Verificar status
docker compose ps

# Voc√™ deve ver todos os servi√ßos como "running":
# - vertice-bot
# - postgres
# - redis
# - prometheus
# - grafana
```

### üìä Passo 3: Acessar Interfaces Web

Depois de iniciar, voc√™ pode acessar:

- **Grafana (Dashboards):** http://localhost:3000
  - Usu√°rio: `admin`
  - Senha: `admin` (mude na primeira vez)

- **Prometheus (M√©tricas):** http://localhost:9090

- **Bot Metrics Endpoint:** http://localhost:9090/metrics

### üìù Passo 4: Ver Logs do Bot

```bash
# Ver logs em tempo real
docker compose logs -f bot

# Ver √∫ltimas 100 linhas
docker compose logs --tail=100 bot

# Ver logs de todos os servi√ßos
docker compose logs -f
```

### üõë Passo 5: Parar os Servi√ßos

```bash
# Parar tudo (mas manter dados)
docker compose stop

# Parar e REMOVER containers (dados ficam salvos)
docker compose down

# Parar e REMOVER TUDO (incluindo volumes - CUIDADO!)
docker compose down -v
```

### üîÑ Passo 6: Reiniciar Ap√≥s Mudan√ßas no C√≥digo

```bash
# 1. Parar containers
docker compose down

# 2. Recompilar TypeScript
npm run build

# 3. Rebuild da imagem Docker
docker compose build bot

# 4. Iniciar novamente
docker compose up -d

# 5. Ver logs
docker compose logs -f bot
```

---

## 6. CONFIGURANDO INTEGRA√á√ïES EXTERNAS

### üîê Google Safe Browsing (Detec√ß√£o de URLs Maliciosas)

**Por que usar?** Melhora MUITO a detec√ß√£o de phishing e malware.

#### Passo 1: Criar Projeto no Google Cloud

1. Acesse: https://console.cloud.google.com/
2. Crie um projeto (ex: `vertice-bot`)
3. Ative a API: https://console.cloud.google.com/apis/library/safebrowsing.googleapis.com
4. Clique em **"Enable"** (Ativar)

#### Passo 2: Criar API Key

1. V√° para: https://console.cloud.google.com/apis/credentials
2. Clique em **"Create Credentials"** ‚Üí **"API Key"**
3. Copie a chave que apareceu
4. (Opcional) Clique em **"Restrict Key"** e limite para Safe Browsing API

#### Passo 3: Adicionar no .env

```bash
GOOGLE_SAFE_BROWSING_API_KEY=AIzaSyAbc123def456ghi789jklMNO012pqrSTU
```

**‚úÖ Pronto! Reinicie o bot.**

---

### ü¶† VirusTotal (An√°lise de Malware)

**Por que usar?** Verifica arquivos e URLs contra 70+ antiv√≠rus.

#### Passo 1: Criar Conta

1. Acesse: https://www.virustotal.com/
2. Crie uma conta gratuita (Sign Up)
3. Confirme o email

#### Passo 2: Obter API Key

1. Fa√ßa login
2. V√° para: https://www.virustotal.com/gui/my-apikey
3. Copie a API Key

#### Passo 3: Adicionar no .env

```bash
VIRUSTOTAL_API_KEY=a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0
```

**‚úÖ Pronto! Reinicie o bot.**

---

### üîç MISP (Threat Intelligence Platform)

**O que √©?** Plataforma open-source para compartilhar intelig√™ncia de amea√ßas.

**Quando usar?** Se voc√™ tem uma inst√¢ncia MISP ou usa um servi√ßo p√∫blico.

#### Op√ß√£o A: Usar MISP via Docker (Local)

```bash
# 1. Iniciar MISP no Docker Compose
docker compose up -d misp

# 2. Aguardar 2-3 minutos (primeira vez √© lenta)

# 3. Acessar MISP Web UI
# URL: https://localhost:443
# Usu√°rio: admin@admin.test
# Senha: admin (mude depois)

# 4. Criar API Key no MISP
# MISP Web ‚Üí Administration ‚Üí List Users ‚Üí admin ‚Üí Auth Keys ‚Üí Add

# 5. Copiar a API Key e adicionar no .env
```

#### Op√ß√£o B: Usar MISP Externo

```bash
# Adicione no .env:
MISP_ENABLED=true
MISP_URL=https://misp.example.com
MISP_API_KEY=sua_api_key_aqui
```

**‚úÖ Pronto! Reinicie o bot.**

---

### üåê OpenCTI (Cyber Threat Intelligence)

**O que √©?** Plataforma de intelig√™ncia de amea√ßas com grafos.

**Quando usar?** Para an√°lise avan√ßada de campanhas de amea√ßas.

#### Op√ß√£o A: Usar OpenCTI via Docker (Local)

```bash
# 1. Iniciar OpenCTI no Docker Compose
docker compose up -d opencti

# 2. Aguardar 5 minutos (primeira vez √© MUITO lenta)

# 3. Acessar OpenCTI Web UI
# URL: http://localhost:8080
# Usu√°rio: admin@opencti.io
# Senha: admin (mude depois)

# 4. Criar API Token no OpenCTI
# OpenCTI ‚Üí Profile (canto superior direito) ‚Üí API Access ‚Üí Create token

# 5. Copiar o token e adicionar no .env
```

#### Op√ß√£o B: Usar OpenCTI Externo

```bash
# Adicione no .env:
OPENCTI_ENABLED=true
OPENCTI_URL=https://opencti.example.com
OPENCTI_API_KEY=seu_token_aqui
```

**‚úÖ Pronto! Reinicie o bot.**

---

### üìä Prometheus + Grafana (Monitoramento)

**J√° vem configurado no Docker Compose!**

#### Acessar Grafana

1. URL: http://localhost:3000
2. Usu√°rio: `admin`
3. Senha: `admin` (mude na primeira vez)

#### Importar Dashboard Pr√©-Configurado

1. No Grafana, v√° em: **Dashboards** ‚Üí **Import**
2. Cole o ID: `1860` (Node Exporter Full)
3. Clique em **Load** ‚Üí **Import**

#### Criar Dashboard Customizado

1. **Dashboards** ‚Üí **New Dashboard** ‚Üí **Add Visualization**
2. Selecione **Prometheus** como data source
3. Query de exemplo:
   ```promql
   # Total de amea√ßas detectadas
   sum(threat_detections_total)

   # Taxa de detec√ß√£o por minuto
   rate(threat_detections_total[1m])

   # Servidores ativos
   discord_guilds_total
   ```

---

## 7. COMANDOS DISPON√çVEIS NO DISCORD

### üîß Comandos de Administra√ß√£o

#### `/ban`
**Descri√ß√£o:** Bane um usu√°rio do servidor

**Uso:**
```
/ban user:@Usuario reason:Spam messages:7days
```

**Par√¢metros:**
- `user`: Usu√°rio a ser banido (obrigat√≥rio)
- `reason`: Motivo do ban (opcional)
- `messages`: Deletar mensagens (op√ß√µes: 1hour, 6hours, 12hours, 1day, 3days, 7days)

**Permiss√µes necess√°rias:** `BAN_MEMBERS`

---

#### `/incident`
**Descri√ß√£o:** Gerenciar casos de resposta a incidentes

**Uso:**
```
/incident create type:phishing severity:high description:Ataque de phishing detectado
/incident list
/incident close case_id:INC-1234
```

**Subcomandos:**
- `create`: Criar novo caso
  - `type`: Tipo do incidente (phishing, malware, spam, raid, other)
  - `severity`: Severidade (low, medium, high, critical)
  - `description`: Descri√ß√£o detalhada
- `list`: Listar casos abertos
- `close`: Fechar um caso
  - `case_id`: ID do caso (ex: INC-1234)
  - `resolution`: Resumo da resolu√ß√£o

**Permiss√µes necess√°rias:** `ADMINISTRATOR` ou `MODERATE_MEMBERS`

---

#### `/automod`
**Descri√ß√£o:** Configurar regras de auto-modera√ß√£o

**Uso:**
```
/automod create name:Anti-Spam action:timeout enabled:true
/automod list
/automod delete rule_id:123
```

**Subcomandos:**
- `create`: Criar nova regra
- `list`: Listar regras ativas
- `delete`: Deletar uma regra
- `toggle`: Ativar/desativar uma regra

---

### üîç Comandos de Seguran√ßa

#### `/scan`
**Descri√ß√£o:** Escanear URL ou arquivo manualmente

**Uso:**
```
/scan url:https://example.com/suspicious
/scan file:[anexo]
```

**O bot vai:**
1. Analisar a URL/arquivo
2. Consultar Google Safe Browsing, VirusTotal, MISP
3. Retornar relat√≥rio de amea√ßas

---

#### `/threatinfo`
**Descri√ß√£o:** Ver informa√ß√µes sobre detec√ß√µes recentes

**Uso:**
```
/threatinfo
/threatinfo user:@Usuario
```

**Mostra:**
- Total de amea√ßas detectadas (√∫ltimas 24h)
- Tipos de amea√ßas
- A√ß√µes tomadas
- Score m√©dio

---

### üìä Comandos de Estat√≠sticas

#### `/stats`
**Descri√ß√£o:** Estat√≠sticas do servidor

**Uso:**
```
/stats
```

**Mostra:**
- Total de membros
- Amea√ßas detectadas (hoje)
- Casos abertos
- Uptime do bot

---

#### `/audit`
**Descri√ß√£o:** Ver audit log de a√ß√µes de modera√ß√£o

**Uso:**
```
/audit
/audit user:@Usuario
/audit action:ban
```

**Filtros:**
- `user`: Ver a√ß√µes de um moderador espec√≠fico
- `action`: Filtrar por tipo (ban, kick, timeout, delete)
- `limit`: N√∫mero de registros (padr√£o: 10)

---

### üõ†Ô∏è Comandos de Utilidade

#### `/ping`
**Descri√ß√£o:** Testar lat√™ncia do bot

**Uso:**
```
/ping
```

**Retorna:**
- Latency: tempo de resposta em ms
- API Latency: lat√™ncia da API do Discord

---

#### `/help`
**Descri√ß√£o:** Listar todos os comandos dispon√≠veis

**Uso:**
```
/help
/help command:ban
```

---

## 8. TROUBLESHOOTING

### ‚ùå Problema: "npm: command not found"

**Causa:** Node.js n√£o est√° instalado ou n√£o est√° no PATH.

**Solu√ß√£o:**
```bash
# Verificar se Node.js est√° instalado
node --version

# Se n√£o retornar vers√£o, reinstale Node.js (volte ao Passo 2A)
```

---

### ‚ùå Problema: "Error: Incorrect login details were provided"

**Causa:** Token do Discord inv√°lido ou expirado.

**Solu√ß√£o:**
1. Volte ao Discord Developer Portal
2. V√° em Bot ‚Üí Reset Token
3. Copie o novo token
4. Atualize `.env` com o novo `DISCORD_TOKEN`
5. Reinicie o bot

---

### ‚ùå Problema: "Missing Access" ou "Missing Permissions"

**Causa:** Bot n√£o tem permiss√µes suficientes no servidor.

**Solu√ß√£o:**
1. No Discord, v√° em: **Configura√ß√µes do Servidor** ‚Üí **Roles** (Cargos)
2. Encontre o cargo do bot
3. Ative as permiss√µes:
   - ‚úÖ Administrator (mais f√°cil) OU
   - ‚úÖ Manage Messages, Manage Roles, Ban Members, Kick Members, Moderate Members

---

### ‚ùå Problema: "Disallowed Intents: MESSAGE_CONTENT"

**Causa:** MESSAGE CONTENT INTENT n√£o est√° ativado.

**Solu√ß√£o:**
1. Discord Developer Portal ‚Üí Seu App ‚Üí Bot
2. Role at√© "Privileged Gateway Intents"
3. ‚úÖ Ative **MESSAGE CONTENT INTENT**
4. Clique em **Save Changes**
5. Reinicie o bot

**‚ö†Ô∏è Se n√£o aparecer a op√ß√£o:** Seu bot est√° em mais de 100 servidores. Voc√™ precisa verificar a aplica√ß√£o (processo mais complexo).

---

### ‚ùå Problema: "Cannot find module './commands/xxx'"

**Causa:** Voc√™ n√£o compilou o TypeScript para JavaScript.

**Solu√ß√£o:**
```bash
# Compilar projeto
npm run build

# Verificar se criou a pasta dist/
ls dist/

# Rodar novamente
npm start
```

---

### ‚ùå Problema: "ECONNREFUSED" ao conectar no banco de dados

**Causa:** PostgreSQL n√£o est√° rodando.

**Solu√ß√£o:**

#### Se usando Docker:
```bash
# Verificar se PostgreSQL est√° rodando
docker compose ps

# Se n√£o estiver, iniciar
docker compose up -d postgres

# Ver logs
docker compose logs postgres
```

#### Se usando PostgreSQL externo:
```bash
# Verificar se est√° rodando
sudo systemctl status postgresql  # Linux
brew services list  # macOS

# Iniciar se necess√°rio
sudo systemctl start postgresql  # Linux
brew services start postgresql  # macOS
```

---

### ‚ùå Problema: "Redis connection refused"

**Causa:** Redis n√£o est√° rodando.

**Solu√ß√£o:**
```bash
# Se usando Docker:
docker compose up -d redis

# Se usando Redis externo:
sudo systemctl start redis  # Linux
brew services start redis  # macOS
```

**Alternativa:** Desabilitar Redis temporariamente (edite `.env`):
```bash
REDIS_URL=
```

---

### ‚ùå Problema: Bot fica offline imediatamente

**Causa:** Erro fatal no c√≥digo.

**Solu√ß√£o:**
```bash
# Ver logs detalhados
npm run dev

# Procure por erros em vermelho (red text)
# Leia a mensagem de erro e procure neste manual

# Se n√£o encontrar solu√ß√£o, abra uma issue no GitHub:
# https://github.com/JuanCS-Dev/Maximus-BOT/issues
```

---

### ‚ùå Problema: "Prisma Client not generated"

**Causa:** Prisma Client n√£o foi gerado.

**Solu√ß√£o:**
```bash
# Gerar Prisma Client
npm run prisma:generate

# Rodar migrations
npm run prisma:push

# Reiniciar bot
npm run dev
```

---

### ‚ùå Problema: Comandos n√£o aparecem no Discord

**Causa:** Comandos n√£o foram registrados.

**Solu√ß√£o:**
```bash
# 1. Verificar se GUILD_ID est√° correto no .env
# 2. Parar o bot (Ctrl + C)
# 3. Deletar comandos antigos (se houver):
npm run commands:clear

# 4. Reiniciar bot (vai re-registrar automaticamente)
npm run dev

# 5. Aguardar 1 minuto
# 6. No Discord, digite "/" e veja se os comandos aparecem
```

**Se ainda n√£o aparecer:**
```bash
# Registrar comandos globalmente (leva at√© 1 hora)
# Remova GUILD_ID do .env temporariamente
# Reinicie o bot
```

---

### üÜò Ainda N√£o Funciona?

1. **Verifique os logs:**
   ```bash
   npm run dev 2>&1 | tee bot.log
   # Salva logs em bot.log
   ```

2. **Abra uma issue no GitHub:**
   - URL: https://github.com/JuanCS-Dev/Maximus-BOT/issues
   - Inclua:
     - Descri√ß√£o do problema
     - Logs de erro (sem o token!)
     - Sistema operacional
     - Vers√£o do Node.js (`node --version`)

3. **Pergunte na comunidade:**
   - Discord do projeto (se houver)
   - Stack Overflow (tag: discord.js)

---

## 9. COMO ADICIONAR NOVOS COMANDOS

### üìù Estrutura de um Comando

Todos os comandos ficam em: `src/commands/`

**Exemplo: Criar comando `/kick`**

```typescript
// src/commands/kick.ts

import { SlashCommandBuilder, PermissionFlagsBits } from 'discord.js';
import { CommandType } from '../types';

const kick: CommandType = {
  // Defini√ß√£o do comando (nome, descri√ß√£o, op√ß√µes)
  data: new SlashCommandBuilder()
    .setName('kick')
    .setDescription('Expulsa um usu√°rio do servidor')
    .addUserOption(option =>
      option
        .setName('user')
        .setDescription('Usu√°rio a ser expulso')
        .setRequired(true)
    )
    .addStringOption(option =>
      option
        .setName('reason')
        .setDescription('Motivo da expuls√£o')
        .setRequired(false)
    )
    .setDefaultMemberPermissions(PermissionFlagsBits.KickMembers),

  // L√≥gica de execu√ß√£o
  async execute(interaction) {
    try {
      // 1. Obter par√¢metros
      const targetUser = interaction.options.getUser('user', true);
      const reason = interaction.options.getString('reason') || 'Sem motivo especificado';

      // 2. Obter membro do servidor
      const member = await interaction.guild?.members.fetch(targetUser.id);

      if (!member) {
        return interaction.reply({
          content: '‚ùå Usu√°rio n√£o encontrado no servidor.',
          ephemeral: true,
        });
      }

      // 3. Verificar se pode expulsar
      if (!member.kickable) {
        return interaction.reply({
          content: '‚ùå N√£o posso expulsar este usu√°rio (hierarquia ou permiss√µes).',
          ephemeral: true,
        });
      }

      // 4. Executar kick
      await member.kick(reason);

      // 5. Responder sucesso
      await interaction.reply({
        content: `‚úÖ ${targetUser.tag} foi expulso.\n**Motivo:** ${reason}`,
      });

    } catch (error) {
      console.error('Erro ao executar /kick:', error);
      await interaction.reply({
        content: '‚ùå Erro ao expulsar usu√°rio.',
        ephemeral: true,
      });
    }
  },
};

export default kick;
```

### üîÑ Passos para Adicionar o Comando

1. **Criar arquivo:** `src/commands/kick.ts` (copie o c√≥digo acima)
2. **Salvar o arquivo**
3. **Recompilar:**
   ```bash
   npm run build
   ```
4. **Reiniciar bot:**
   ```bash
   npm run dev
   ```
5. **Testar no Discord:** `/kick @Usuario reason:Spam`

**‚úÖ O comando √© registrado automaticamente!**

---

### üìö Recursos para Aprender Mais

- **Discord.js Docs:** https://discord.js.org/docs
- **Discord.js Guide:** https://discordjs.guide/
- **Slash Commands Guide:** https://discordjs.guide/creating-your-bot/slash-commands.html

---

## 10. PERGUNTAS FREQUENTES (FAQ)

### ‚ùì Preciso pagar para usar o bot?

**Resposta:** N√£o! O bot √© 100% open-source e gratuito. Voc√™ s√≥ precisa de:
- Um servidor para rodar (pode ser seu pr√≥prio PC)
- APIs externas (Google Safe Browsing, VirusTotal) t√™m planos gratuitos

---

### ‚ùì Quantos servidores o bot suporta?

**Resposta:**
- **Modo normal:** At√© 2.500 servidores
- **Modo sharding:** Ilimitado (configur√°vel)

---

### ‚ùì O bot funciona no Windows?

**Resposta:** Sim! Funciona em:
- ‚úÖ Windows 10/11
- ‚úÖ Linux (Ubuntu, Debian, Fedora, etc.)
- ‚úÖ macOS (Intel e Apple Silicon)

---

### ‚ùì Posso hospedar o bot na nuvem?

**Resposta:** Sim! Funciona em:
- ‚úÖ Google Cloud Run
- ‚úÖ AWS (EC2, ECS, Lambda)
- ‚úÖ Azure (Container Instances)
- ‚úÖ DigitalOcean (Droplets)
- ‚úÖ Heroku (com Dockerfile)
- ‚úÖ VPS qualquer (com Docker)

---

### ‚ùì O bot coleta dados dos usu√°rios?

**Resposta:**
- **Dados armazenados:** IDs de usu√°rios/mensagens (para auditoria)
- **Dados N√ÉO armazenados:** Conte√∫do de mensagens (apenas IOCs)
- **LGPD/GDPR:** Compliant (voc√™ controla os dados)

---

### ‚ùì Como atualizar o bot quando houver nova vers√£o?

```bash
# 1. Parar o bot
docker compose down  # se usando Docker
# OU Ctrl+C se rodando npm run dev

# 2. Atualizar c√≥digo
git pull origin main

# 3. Instalar novas depend√™ncias
npm install

# 4. Recompilar
npm run build

# 5. Rodar migrations (se houver)
npm run prisma:migrate:deploy

# 6. Reiniciar
docker compose up -d  # Docker
# OU npm run dev
```

---

### ‚ùì Posso modificar o c√≥digo?

**Resposta:** Sim! Licen√ßa MIT permite:
- ‚úÖ Uso comercial
- ‚úÖ Modifica√ß√£o
- ‚úÖ Distribui√ß√£o
- ‚úÖ Uso privado

**Apenas mantenha a licen√ßa e cr√©ditos originais.**

---

### ‚ùì O bot detecta 100% das amea√ßas?

**Resposta:** N√£o. Nenhum sistema √© 100% eficaz. O bot usa m√∫ltiplas camadas:
- Google Safe Browsing (~95% de URLs maliciosas)
- VirusTotal (~90% de malware conhecido)
- Pattern matching (~70% de conte√∫do suspeito)
- MISP/OpenCTI (depende da base de dados)

**Sempre combine com modera√ß√£o humana!**

---

### ‚ùì Como reportar bugs ou pedir features?

1. **GitHub Issues:** https://github.com/JuanCS-Dev/Maximus-BOT/issues
2. **Pull Requests:** Contribui√ß√µes s√£o bem-vindas!
3. **Discord:** (se houver servidor oficial)

---

## 11. GLOSS√ÅRIO

### üî§ Termos T√©cnicos Explicados

**API (Application Programming Interface)**
‚Üí Forma de um software conversar com outro. Ex: Bot conversa com Discord via API.

**Bot**
‚Üí Programa automatizado que responde a comandos no Discord.

**Container (Docker)**
‚Üí Como uma "caixa virtual" que roda aplica√ß√µes isoladas.

**Docker Compose**
‚Üí Ferramenta para rodar m√∫ltiplos containers juntos (bot + banco + Redis).

**Environment Variables (.env)**
‚Üí Arquivo secreto com senhas, tokens, URLs.

**Intent (Discord)**
‚Üí "Permiss√£o" que o bot precisa para acessar dados (ex: ler mensagens).

**IOC (Indicator of Compromise)**
‚Üí Sinal de amea√ßa: URL suspeita, hash de malware, IP malicioso.

**MISP (Malware Information Sharing Platform)**
‚Üí Plataforma para compartilhar intelig√™ncia de amea√ßas.

**OpenCTI (Open Cyber Threat Intelligence)**
‚Üí Plataforma de intelig√™ncia de amea√ßas com grafos.

**Prisma**
‚Üí ORM (mapeador de banco de dados) que facilita trabalhar com PostgreSQL.

**PostgreSQL**
‚Üí Banco de dados relacional (armazena usu√°rios, amea√ßas, audit logs).

**Prometheus**
‚Üí Sistema de monitoramento que coleta m√©tricas do bot.

**Redis**
‚Üí Banco de dados em mem√≥ria (r√°pido) usado para cache e rate limiting.

**Sharding**
‚Üí Dividir o bot em m√∫ltiplas inst√¢ncias para escalar (2.500+ servidores).

**Slash Command (/comando)**
‚Üí Comando nativo do Discord (aparece com "/" e tem autocomplete).

**STIX (Structured Threat Information eXpression)**
‚Üí Padr√£o para representar amea√ßas cibern√©ticas.

**TAXII (Trusted Automated eXchange of Indicator Information)**
‚Üí Protocolo para trocar informa√ß√µes de amea√ßas.

**Threat Intelligence**
‚Üí Intelig√™ncia sobre amea√ßas cibern√©ticas (quem ataca, como, quando).

**Token (Discord)**
‚Üí "Senha" do bot para se conectar ao Discord. NUNCA compartilhe!

**TypeScript**
‚Üí JavaScript com tipos (detecta erros antes de rodar).

**V√©rtice-MAXIMUS**
‚Üí Ecossistema de seguran√ßa cibern√©tica (integra√ß√£o opcional).

**VirusTotal**
‚Üí Servi√ßo que analisa arquivos/URLs com 70+ antiv√≠rus.

**Webhook**
‚Üí URL que recebe notifica√ß√µes (ex: alertas de amea√ßas).

---

## üéâ CONCLUS√ÉO

Parab√©ns! Se voc√™ chegou at√© aqui, voc√™ agora √© capaz de:

‚úÖ Instalar e configurar o bot
‚úÖ Rodar em desenvolvimento e produ√ß√£o
‚úÖ Configurar integra√ß√µes externas
‚úÖ Adicionar novos comandos
‚úÖ Resolver problemas comuns
‚úÖ Monitorar o bot com Grafana

### üöÄ Pr√≥ximos Passos

1. **Teste o bot** no seu servidor Discord
2. **Configure alertas** para seu canal de modera√ß√£o
3. **Adicione APIs** (Google Safe Browsing, VirusTotal)
4. **Customize comandos** para suas necessidades
5. **Deploy em produ√ß√£o** (VPS ou cloud)
6. **Monitore m√©tricas** com Grafana

### üìñ Documenta√ß√£o Adicional

- **README.md** - Vis√£o geral do projeto
- **VALIDATION_CERTIFICATE.md** - Certificado de valida√ß√£o E2E
- **PROJECT_COMPLETE.md** - Documenta√ß√£o t√©cnica completa
- **MASTER_PLAN.md** - Plano de implementa√ß√£o por fases

### ü§ù Contribua!

Este projeto √© open-source. Contribui√ß√µes s√£o bem-vindas:
- üêõ Reporte bugs
- üí° Sugira features
- üîß Envie pull requests
- üìñ Melhore a documenta√ß√£o

**GitHub:** https://github.com/JuanCS-Dev/Maximus-BOT

---

**Desenvolvido com ‚ù§Ô∏è para o Sistema V√©rtice**
**√öltima atualiza√ß√£o:** 2025-10-29

---

## üìû SUPORTE

**Encontrou um problema n√£o listado aqui?**

1. ‚úÖ Revise este manual novamente (Ctrl+F para buscar)
2. ‚úÖ Verifique os logs de erro
3. ‚úÖ Abra uma issue no GitHub
4. ‚úÖ Pergunte na comunidade Discord (se dispon√≠vel)

**Lembre-se:** N√£o compartilhe seu token do Discord em NENHUMA circunst√¢ncia!

---

**FIM DO MANUAL ANTIBURRO** üéØ
